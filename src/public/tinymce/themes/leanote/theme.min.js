tinymce.ThemeManager.add("leanote",function(a){function b(){function b(b){var d,e=[];if(b){var f=0,g=($("#mceToolbar").width()-40,!1);return l(b.split(/[ ,]/),function(b){function c(){var c=a.selection;"bullist"==h&&c.selectorChanged("ul > li",function(a,c){for(var d,e=c.parents.length;e--&&(d=c.parents[e].nodeName,"OL"!=d&&"UL"!=d););b.active(a&&"UL"==d)}),"numlist"==h&&c.selectorChanged("ol > li",function(a,c){for(var d,e=c.parents.length;e--&&(d=c.parents[e].nodeName,"OL"!=d&&"UL"!=d););b.active(a&&"OL"==d)}),b.settings.stateSelector&&c.selectorChanged(b.settings.stateSelector,function(a){b.active(a)},!0),"leanote_code"!=h&&(b.settings.disabledStateSelector="pre",c.selectorChanged(b.settings.disabledStateSelector,function(a){b.disabled(a)}))}var h;if("|"==b)d=null,g=!0;else if(k.has(b))b={type:b},j.toolbar_items_size&&(b.size=j.toolbar_items_size),e.push(b),d=null;else if(a.buttons[b]){h=b,b=a.buttons[h],"function"==typeof b&&(b=b()),b.type=b.type||"button",j.toolbar_items_size&&(b.size=j.toolbar_items_size),b=k.create(b),f++;var i=($("#popularToolbar").width(),b.renderHtml());g&&($("#popularToolbar").append('<span class="tool-split">|</span>'),g=!1),$("#popularToolbar").append(i),b.postRender(),a.initialized?c():a.on("init",c)}}),c.push({type:"toolbar",layout:"flow",items:e}),!0}}for(var c=[],d=1;10>d&&b(j["toolbar"+d]);d++);return c.length||b(j.toolbar||o),c}function c(){function b(b){var c;return"|"==b?{text:"|"}:c=a.menuItems[b]}function c(c){var d,e,f,g,h;if(h=tinymce.makeMap((j.removed_menuitems||"").split(/[ ,]/)),j.menu?(e=j.menu[c],g=!0):e=n[c],e){d={text:e.title},f=[],l((e.items||"").split(/[ ,]/),function(a){var c=b(a);c&&!h[a]&&f.push(b(a))}),g||l(a.menuItems,function(a){a.context==c&&("before"==a.separator&&f.push({text:"|"}),a.prependToContext?f.unshift(a):f.push(a),"after"==a.separator&&f.push({text:"|"}))});for(var i=0;i<f.length;i++)"|"==f[i].text&&(0===i||i==f.length-1)&&f.splice(i,1);if(d.menu=f,!d.menu.length)return null}return d}var d,e=[],f=[];if(j.menu)for(d in j.menu)f.push(d);else for(d in n)f.push(d);for(var g="string"==typeof j.menubar?j.menubar.split(/[ ,]/):f,h=0;h<g.length;h++){var i=g[h];i=c(i),i&&e.push(i)}return e}function d(b){function c(a){var c=b.find(a)[0];c&&c.focus()}a.shortcuts.add("Alt+F9","",function(){c("menubar")}),a.shortcuts.add("Alt+F10","",function(){c("toolbar")}),a.shortcuts.add("Alt+F11","",function(){c("elementpath")}),b.on("cancel",function(){a.focus()})}function e(b,c){function d(a){return{width:a.clientWidth,height:a.clientHeight}}var e,f,g,h;e=a.getContainer(),f=a.getContentAreaContainer().firstChild,g=d(e),h=d(f),null!==b&&(b=Math.max(j.min_width||100,b),b=Math.min(j.max_width||65535,b),m.css(e,"width",b+(g.width-h.width)),m.css(f,"width",b)),c=Math.max(j.min_height||100,c),c=Math.min(j.max_height||65535,c),m.css(f,"height",c),a.fire("ResizeEditor")}function f(b,c){var d=a.getContentAreaContainer();i.resizeTo(d.clientWidth+b,d.clientHeight+c)}function g(){function e(){if(l&&l.moveRel&&l.visible()&&!l._fixed){var b=a.selection.getScrollContainer(),c=a.getBody(),d=0,e=0;if(b){var f=m.getPos(c),g=m.getPos(b);d=Math.max(0,g.x-f.x),e=Math.max(0,g.y-f.y)}l.fixed(!1).moveRel(c,a.rtl?["tr-br","br-tr"]:["tl-bl","bl-tl"]).moveBy(d,e)}}function f(){l&&(l.show(),e(),m.addClass(a.getBody(),"mce-edit-focus"))}function g(){l&&(l.hide(),m.removeClass(a.getBody(),"mce-edit-focus"))}function h(){return l?void(l.visible()||f()):(l=i.panel=k.create({type:n?"panel":"floatpanel",classes:"tinymce tinymce-inline",layout:"flex",direction:"column",align:"stretch",autohide:!1,autofix:!0,fixed:!!n,border:1,items:[j.menubar===!1?null:{type:"menubar",border:"0 0 1 0",items:c()},j.toolbar===!1?null:{type:"panel",name:"toolbar",layout:"stack",items:b()}]}),l.renderTo(n||document.body).reflow(),d(l),f(),a.on("nodeChange",e),a.on("activate",f),void a.on("deactivate",g))}var l,n;return j.fixed_toolbar_container&&(n=m.select(j.fixed_toolbar_container)[0]),j.content_editable=!0,setTimeout(function(){h()}),a.on("focus",h),a.on("remove",function(){l&&(l.remove(),l=null)}),{}}function h(f){var g,h,l,m='<div id="noteTitleDiv"><input name="noteTitle" id="noteTitle" placeholder="Title" ></div>';m="",b();var n=[j.menubar===!1?null:{type:"menubar",border:"0 0 1 0",items:c()},null,{type:"panel",name:"iframe",layout:"stack",classes:"edit-area ifr",html:m,border:"1 0 0 0"}];return g=i.panel=k.create({type:"panel",classes:"tinymce",style:"visibility: hidden",layout:"stack",border:1,items:n}),j.resize!==!1&&(h={type:"resizehandle",direction:j.resize,onResizeStart:function(){var b=a.getContentAreaContainer().firstChild;l={width:b.clientWidth,height:b.clientHeight}},onResize:function(a){"both"==j.resize?e(l.width+a.deltaX,l.height+a.deltaY):e(null,l.height+a.deltaY)}}),j.statusbar!==!1&&g.add({type:"panel",name:"statusbar",classes:"statusbar",layout:"flow",border:"1 0 0 0",items:[{type:"elementpath"},h]}),j.readonly&&g.find("*").disabled(!0),g.renderBefore(f.targetNode).reflow(),j.width&&tinymce.DOM.setStyle(g.getEl(),"width",j.width),a.on("remove",function(){g.remove(),g=null}),d(g),{iframeContainer:g.find("#iframe")[0].getEl(),editorContainer:g.getEl()}}var i=this,j=a.settings,k=tinymce.ui.Factory,l=tinymce.each,m=tinymce.DOM,n={file:{title:"File",items:"newdocument"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall"},insert:{title:"Insert",items:"|"},view:{title:"View",items:"visualaid |"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript | formats | removeformat"},table:{title:"Table"},tools:{title:"Tools"}},o="undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image";i.renderUI=function(b){j.skin!==!1?j.skin||"lightgray":!1;return a.on("ProgressState",function(a){i.throbber=i.throbber||new tinymce.ui.Throbber(i.panel.getEl("body")),a.state?i.throbber.show(a.time):i.throbber.hide()}),j.inline?g(b):h(b)},i.resizeTo=e,i.resizeBy=f});